#include <msp430.h>
#include "libTimer.h"
#include "led.h"
#include "switches.h"
#include "buzzer.h"
#include "lcdutils.h"
#include "lcddraw.h"
#include "stateMachine.h"
#include "lcdDisplay.h"


void main() 
{
  // P1DIR |= LED_GREEN;
  // P1OUT = LED_GREEN;
  
  configureClocks();
  clearScreen(COLOR_GREEN);
  switch_init();
  buzzer_init();
  led_init();
  enableWDTInterrupts();

  lcd_init();
  u_char width = screenWidth, height = screenHeight;

  drawInit();
  
  drawString11x16(32,50, "test", COLOR_PINK, COLOR_BLUE);
  //drawString8x12(20,90,"test2", COLOR_PINK, COLOR_BLUE);
  drawString5x7(50,130,"test2", COLOR_PINK, COLOR_BLUE);
  triangleShow();
  or_sr(0x8);  // GIE on
  for(;;) {
    while(!redrawScreen){
      P1OUT &= ~LED_GREEN;
      or_sr(0x10);
    }
     P1OUT |= LED_GREEN;
    redrawScreen = 0;
  }
}

void wdt_c_handler() {
  static short count = 0;
  P1OUT |= LED_GREEN;
  count++;
    if (count == 15) {
      switch_interrupt_handler();
      count = 0;
    }
    P1OUT &= ~LED_GREEN;
}
  
  
